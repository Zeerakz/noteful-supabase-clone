
/* Frosted Glass Effect for Sidebar */

/* Base frosted glass container */
.frosted-glass-sidebar {
  position: relative;
  overflow: hidden;
  /* Fallback background for mobile or unsupported browsers */
  background-color: hsl(var(--sidebar-background) / 0.85);
}

/* Desktop-only frosted glass effect using enlarged, masked child technique */
@media (min-width: 768px) {
  .frosted-glass-sidebar {
    /* Remove fallback background on desktop */
    background-color: transparent;
  }
  
  /* The enlarged child that creates the blur effect */
  .frosted-glass-sidebar::before {
    content: '';
    position: absolute;
    top: -20px;
    left: -20px;
    right: -20px;
    bottom: -20px;
    z-index: -1;
    
    /* Apply the backdrop blur to the enlarged area */
    backdrop-filter: blur(12px) saturate(1.2);
    -webkit-backdrop-filter: blur(12px) saturate(1.2);
    
    /* Semi-transparent background overlay */
    background-color: hsl(var(--sidebar-background) / 0.75);
    
    /* Subtle border for definition */
    border: 1px solid hsl(var(--sidebar-border) / 0.2);
    border-radius: 12px;
    
    /* Performance optimizations */
    will-change: backdrop-filter;
    transform: translateZ(0);
  }
  
  /* The mask that clips the enlarged child to the sidebar bounds */
  .frosted-glass-sidebar::after {
    content: '';
    position: absolute;
    inset: 0;
    z-index: -1;
    background: linear-gradient(
      135deg,
      hsl(var(--sidebar-background) / 0.1) 0%,
      hsl(var(--sidebar-background) / 0.05) 100%
    );
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
    border-radius: inherit;
  }
  
  /* Enhanced glass effect for floating variant */
  .frosted-glass-sidebar[data-variant="floating"]::before {
    border-radius: 16px;
    backdrop-filter: blur(16px) saturate(1.3) brightness(1.1);
    -webkit-backdrop-filter: blur(16px) saturate(1.3) brightness(1.1);
    background-color: hsl(var(--sidebar-background) / 0.7);
    box-shadow: 
      0 8px 32px hsl(var(--foreground) / 0.1),
      inset 0 1px 0 hsl(var(--sidebar-border) / 0.2);
  }
  
  /* Subtle animation for blur transitions */
  .frosted-glass-sidebar::before,
  .frosted-glass-sidebar::after {
    transition: backdrop-filter 0.2s ease-out, background-color 0.2s ease-out;
  }
}

/* Dark mode adjustments */
.dark .frosted-glass-sidebar {
  /* Enhanced fallback for mobile dark mode */
  background-color: hsl(var(--sidebar-background) / 0.9);
}

@media (min-width: 768px) {
  .dark .frosted-glass-sidebar::before {
    background-color: hsl(var(--sidebar-background) / 0.8);
    border-color: hsl(var(--sidebar-border) / 0.3);
  }
  
  .dark .frosted-glass-sidebar::after {
    background: linear-gradient(
      135deg,
      hsl(var(--sidebar-background) / 0.15) 0%,
      hsl(var(--sidebar-background) / 0.08) 100%
    );
  }
  
  .dark .frosted-glass-sidebar[data-variant="floating"]::before {
    background-color: hsl(var(--sidebar-background) / 0.75);
    box-shadow: 
      0 8px 32px hsl(var(--background) / 0.2),
      inset 0 1px 0 hsl(var(--sidebar-border) / 0.3);
  }
}

/* High contrast mode - disable blur for better visibility */
@media (prefers-contrast: high) {
  .frosted-glass-sidebar::before,
  .frosted-glass-sidebar::after {
    backdrop-filter: none !important;
    -webkit-backdrop-filter: none !important;
  }
  
  .frosted-glass-sidebar {
    background-color: hsl(var(--sidebar-background)) !important;
  }
}

/* Reduced motion - disable blur animations */
@media (prefers-reduced-motion: reduce) {
  .frosted-glass-sidebar::before,
  .frosted-glass-sidebar::after {
    transition: none;
  }
}

/* Performance optimization for older devices */
@supports not (backdrop-filter: blur(1px)) {
  .frosted-glass-sidebar::before,
  .frosted-glass-sidebar::after {
    backdrop-filter: none;
    -webkit-backdrop-filter: none;
    background-color: hsl(var(--sidebar-background) / 0.9);
  }
}

/* Content layering to ensure proper stacking */
.frosted-glass-content {
  position: relative;
  z-index: 1;
  height: 100%;
  display: flex;
  flex-direction: column;
}

/* Subtle enhancement for sidebar borders */
.frosted-glass-sidebar .sidebar-border-enhancement {
  position: absolute;
  right: 0;
  top: 0;
  bottom: 0;
  width: 1px;
  background: linear-gradient(
    180deg,
    transparent 0%,
    hsl(var(--sidebar-border) / 0.5) 20%,
    hsl(var(--sidebar-border) / 0.5) 80%,
    transparent 100%
  );
  z-index: 2;
}

@media (max-width: 767px) {
  .frosted-glass-sidebar .sidebar-border-enhancement {
    display: none;
  }
}
